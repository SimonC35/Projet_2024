{"ast":null,"code":"import { openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, vModelText as _vModelText, createElementVNode as _createElementVNode, withDirectives as _withDirectives, toDisplayString as _toDisplayString, withModifiers as _withModifiers, normalizeClass as _normalizeClass, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = {\n  key: 0\n};\nconst _hoisted_2 = {\n  key: 1\n};\nconst _hoisted_3 = {\n  type: \"submit\"\n};\nconst _hoisted_4 = {\n  key: 3\n};\nconst _hoisted_5 = {\n  key: 4\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", null, [$data.isLogin ? (_openBlock(), _createElementBlock(\"h2\", _hoisted_1, \"Connexion\")) : (_openBlock(), _createElementBlock(\"h2\", _hoisted_2, \"Inscription\")), _createElementVNode(\"form\", {\n    onSubmit: _cache[3] || (_cache[3] = _withModifiers((...args) => $options.submitForm && $options.submitForm(...args), [\"prevent\"]))\n  }, [_withDirectives(_createElementVNode(\"input\", {\n    type: \"email\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.email = $event),\n    placeholder: \"Email\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.email]]), !$data.isLogin ? _withDirectives((_openBlock(), _createElementBlock(\"input\", {\n    key: 0,\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.name = $event),\n    placeholder: \"Nom\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */)), [[_vModelText, $data.name]]) : _createCommentVNode(\"v-if\", true), _withDirectives(_createElementVNode(\"input\", {\n    type: \"password\",\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.password = $event),\n    placeholder: \"Mot de passe\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.password]]), _createElementVNode(\"button\", _hoisted_3, _toDisplayString($data.isLogin ? 'Se connecter' : 'S\\'inscrire'), 1 /* TEXT */)], 32 /* NEED_HYDRATION */), $data.message ? (_openBlock(), _createElementBlock(\"p\", {\n    key: 2,\n    class: _normalizeClass($data.messageClass)\n  }, _toDisplayString($data.message), 3 /* TEXT, CLASS */)) : _createCommentVNode(\"v-if\", true), !$data.isLogin ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_createElementVNode(\"p\", null, [_cache[6] || (_cache[6] = _createTextVNode(\"Déjà un compte ? \")), _createElementVNode(\"a\", {\n    href: \"#\",\n    onClick: _cache[4] || (_cache[4] = (...args) => $options.toggleForm && $options.toggleForm(...args))\n  }, \"Se connecter\")])])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_createElementVNode(\"p\", null, [_cache[7] || (_cache[7] = _createTextVNode(\"Pas encore de compte ? \")), _createElementVNode(\"a\", {\n    href: \"#\",\n    onClick: _cache[5] || (_cache[5] = (...args) => $options.toggleForm && $options.toggleForm(...args))\n  }, \"S'inscrire\")])]))]);\n}","map":{"version":3,"names":["key","type","_createElementBlock","$data","isLogin","_hoisted_1","_hoisted_2","_createElementVNode","onSubmit","_cache","_withModifiers","args","$options","submitForm","$event","email","placeholder","required","name","_createCommentVNode","password","_hoisted_3","_toDisplayString","message","class","_normalizeClass","messageClass","_hoisted_4","_createTextVNode","href","onClick","toggleForm","_hoisted_5"],"sources":["/home/felix/Projet_2024/Matts/panimalvue/src/views/AuthPage.vue"],"sourcesContent":["<template>\n    <div>\n      <h2 v-if=\"isLogin\">Connexion</h2>\n      <h2 v-else>Inscription</h2>\n      <form @submit.prevent=\"submitForm\">\n        <input type=\"email\" v-model=\"email\" placeholder=\"Email\" required />\n        <input type=\"text\" v-model=\"name\" placeholder=\"Nom\" v-if=\"!isLogin\" required />\n        <input type=\"password\" v-model=\"password\" placeholder=\"Mot de passe\" required />\n        <button type=\"submit\">{{ isLogin ? 'Se connecter' : 'S\\'inscrire' }}</button>\n      </form>\n      <p v-if=\"message\" :class=\"messageClass\">{{ message }}</p>\n  \n      <div v-if=\"!isLogin\">\n        <p>Déjà un compte ? <a href=\"#\" @click=\"toggleForm\">Se connecter</a></p>\n      </div>\n      <div v-else>\n        <p>Pas encore de compte ? <a href=\"#\" @click=\"toggleForm\">S'inscrire</a></p>\n      </div>\n    </div>\n  </template>\n  \n  <script>\n  import axios from 'axios';\n  \n  export default {\n    data() {\n      return {\n        email: '',\n        name: '',\n        password: '',\n        message: '',\n        messageClass: '',\n        isLogin: true // Contrôle si l'on est dans le mode connexion ou inscription\n      };\n    },\n    methods: {\n      async submitForm() {\n        const url = this.isLogin\n          ? 'http://localhost:8000/api/login/'\n          : 'http://localhost:8000/api/register/';\n        \n        const body = this.isLogin\n          ? { email: this.email, password: this.password }\n          : { name: this.name, email: this.email, password: this.password };\n  \n        try {\n          const response = await axios.post(url, body);\n          this.message = response.data.message || 'Action réussie!';\n          this.messageClass = 'success';\n          \n          // Si la connexion est réussie, rediriger l'utilisateur vers la page protégée\n          if (this.isLogin) {\n            // Stocker les tokens dans le localStorage pour la gestion de la session\n            localStorage.setItem('access_token', response.data.access_token);\n            localStorage.setItem('refresh_token', response.data.refresh_token);\n            \n            // Redirection vers une page protégée après la connexion\n            this.$router.push('/dashboard');\n          }\n        } catch (error) {\n          this.message = error.response.data.error || 'Une erreur est survenue.';\n          this.messageClass = 'error';\n        }\n      },\n      toggleForm() {\n        this.isLogin = !this.isLogin;\n        this.message = ''; // Réinitialiser le message à chaque changement de formulaire\n      }\n    }\n  };\n  </script>\n  \n  <style scoped>\n  /* Ajoute ton style CSS pour le formulaire si nécessaire */\n  </style>\n  "],"mappings":";;EAAAA,GAAA;AAAA;;EAAAA,GAAA;AAAA;;EAQgBC,IAAI,EAAC;AAAQ;;EAR7BD,GAAA;AAAA;;EAAAA,GAAA;AAAA;;uBACIE,mBAAA,CAiBM,cAhBMC,KAAA,CAAAC,OAAO,I,cAAjBF,mBAAA,CAAiC,MAFvCG,UAAA,EAEyB,WAAS,M,cAC5BH,mBAAA,CAA2B,MAHjCI,UAAA,EAGiB,aAAW,IACtBC,mBAAA,CAKO;IALAC,QAAM,EAAAC,MAAA,QAAAA,MAAA,MAJnBC,cAAA,KAAAC,IAAA,KAI6BC,QAAA,CAAAC,UAAA,IAAAD,QAAA,CAAAC,UAAA,IAAAF,IAAA,CAAU;sBAC/BJ,mBAAA,CAAmE;IAA5DN,IAAI,EAAC,OAAO;IAL3B,uBAAAQ,MAAA,QAAAA,MAAA,MAAAK,MAAA,IAKqCX,KAAA,CAAAY,KAAK,GAAAD,MAAA;IAAEE,WAAW,EAAC,OAAO;IAACC,QAAQ,EAAR;iDAA3Bd,KAAA,CAAAY,KAAK,E,IACyBZ,KAAA,CAAAC,OAAO,G,+BAAlEF,mBAAA,CAA+E;IANvFF,GAAA;IAMeC,IAAI,EAAC,MAAM;IAN1B,uBAAAQ,MAAA,QAAAA,MAAA,MAAAK,MAAA,IAMoCX,KAAA,CAAAe,IAAI,GAAAJ,MAAA;IAAEE,WAAW,EAAC,KAAK;IAAiBC,QAAQ,EAAR;kDAAxCd,KAAA,CAAAe,IAAI,E,IANxCC,mBAAA,gB,gBAOQZ,mBAAA,CAAgF;IAAzEN,IAAI,EAAC,UAAU;IAP9B,uBAAAQ,MAAA,QAAAA,MAAA,MAAAK,MAAA,IAOwCX,KAAA,CAAAiB,QAAQ,GAAAN,MAAA;IAAEE,WAAW,EAAC,cAAc;IAACC,QAAQ,EAAR;iDAArCd,KAAA,CAAAiB,QAAQ,E,GACxCb,mBAAA,CAA6E,UAA7Ec,UAA6E,EAAAC,gBAAA,CAApDnB,KAAA,CAAAC,OAAO,kD,4BAEzBD,KAAA,CAAAoB,OAAO,I,cAAhBrB,mBAAA,CAAyD;IAV/DF,GAAA;IAUyBwB,KAAK,EAV9BC,eAAA,CAUgCtB,KAAA,CAAAuB,YAAY;sBAAKvB,KAAA,CAAAoB,OAAO,2BAVxDJ,mBAAA,gB,CAYkBhB,KAAA,CAAAC,OAAO,I,cAAnBF,mBAAA,CAEM,OAdZyB,UAAA,GAaQpB,mBAAA,CAAwE,Y,0BAbhFqB,gBAAA,CAaW,mBAAiB,IAAArB,mBAAA,CAAgD;IAA7CsB,IAAI,EAAC,GAAG;IAAEC,OAAK,EAAArB,MAAA,QAAAA,MAAA,UAAAE,IAAA,KAAEC,QAAA,CAAAmB,UAAA,IAAAnB,QAAA,CAAAmB,UAAA,IAAApB,IAAA,CAAU;KAAE,cAAY,E,sBAElET,mBAAA,CAEM,OAjBZ8B,UAAA,GAgBQzB,mBAAA,CAA4E,Y,0BAhBpFqB,gBAAA,CAgBW,yBAAuB,IAAArB,mBAAA,CAA8C;IAA3CsB,IAAI,EAAC,GAAG;IAAEC,OAAK,EAAArB,MAAA,QAAAA,MAAA,UAAAE,IAAA,KAAEC,QAAA,CAAAmB,UAAA,IAAAnB,QAAA,CAAAmB,UAAA,IAAApB,IAAA,CAAU;KAAE,YAAU,E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}