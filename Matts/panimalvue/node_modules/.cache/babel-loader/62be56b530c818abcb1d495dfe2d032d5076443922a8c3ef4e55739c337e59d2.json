{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from 'axios';\nexport default {\n  data() {\n    return {\n      email: '',\n      name: '',\n      password: '',\n      message: '',\n      messageClass: '',\n      isLogin: true // Contrôle si l'on est dans le mode connexion ou inscription\n    };\n  },\n  methods: {\n    async submitForm() {\n      const url = this.isLogin ? 'http://localhost:8000/api/login/' : 'http://localhost:8000/api/register/';\n      const body = this.isLogin ? {\n        email: this.email,\n        password: this.password\n      } : {\n        name: this.name,\n        email: this.email,\n        password: this.password\n      };\n      try {\n        const response = await axios.post(url, body);\n        this.message = response.data.message || 'Action réussie!';\n        this.messageClass = 'success';\n\n        // Si la connexion est réussie, rediriger l'utilisateur vers la page protégée\n        if (this.isLogin) {\n          // Stocker les tokens dans le localStorage pour la gestion de la session\n          localStorage.setItem('access_token', response.data.access_token);\n          localStorage.setItem('refresh_token', response.data.refresh_token);\n\n          // Redirection vers une page protégée après la connexion\n          this.$router.push('/Home');\n        }\n      } catch (error) {\n        this.message = error.response.data.error || 'Une erreur est survenue.';\n        this.messageClass = 'error';\n      }\n    },\n    toggleForm() {\n      this.isLogin = !this.isLogin;\n      this.message = ''; // Réinitialiser le message à chaque changement de formulaire\n    }\n  }\n};","map":{"version":3,"names":["axios","data","email","name","password","message","messageClass","isLogin","methods","submitForm","url","body","response","post","localStorage","setItem","access_token","refresh_token","$router","push","error","toggleForm"],"sources":["/home/felix/Projet_2024/Matts/panimalvue/src/views/AuthPage.vue"],"sourcesContent":["<template>\n    <div>\n      <h2 v-if=\"isLogin\">Connexion</h2>\n      <h2 v-else>Inscription</h2>\n      <form @submit.prevent=\"submitForm\">\n        <input type=\"email\" v-model=\"email\" placeholder=\"Email\" required />\n        <input type=\"text\" v-model=\"name\" placeholder=\"Nom\" v-if=\"!isLogin\" required />\n        <input type=\"password\" v-model=\"password\" placeholder=\"Mot de passe\" required />\n        <button type=\"submit\">{{ isLogin ? 'Se connecter' : 'S\\'inscrire' }}</button>\n      </form>\n      <p v-if=\"message\" :class=\"messageClass\">{{ message }}</p>\n  \n      <div v-if=\"!isLogin\">\n        <p>Déjà un compte ? <a href=\"#\" @click=\"toggleForm\">Se connecter</a></p>\n      </div>\n      <div v-else>\n        <p>Pas encore de compte ? <a href=\"#\" @click=\"toggleForm\">S'inscrire</a></p>\n      </div>\n    </div>\n  </template>\n  \n  <script>\n  import axios from 'axios';\n  \n  export default {\n    data() {\n      return {\n        email: '',\n        name: '',\n        password: '',\n        message: '',\n        messageClass: '',\n        isLogin: true // Contrôle si l'on est dans le mode connexion ou inscription\n      };\n    },\n    methods: {\n      async submitForm() {\n        const url = this.isLogin\n          ? 'http://localhost:8000/api/login/'\n          : 'http://localhost:8000/api/register/';\n        \n        const body = this.isLogin\n          ? { email: this.email, password: this.password }\n          : { name: this.name, email: this.email, password: this.password };\n  \n        try {\n          const response = await axios.post(url, body);\n          this.message = response.data.message || 'Action réussie!';\n          this.messageClass = 'success';\n          \n          // Si la connexion est réussie, rediriger l'utilisateur vers la page protégée\n          if (this.isLogin) {\n            // Stocker les tokens dans le localStorage pour la gestion de la session\n            localStorage.setItem('access_token', response.data.access_token);\n            localStorage.setItem('refresh_token', response.data.refresh_token);\n            \n            // Redirection vers une page protégée après la connexion\n            this.$router.push('/Home');\n          }\n        } catch (error) {\n          this.message = error.response.data.error || 'Une erreur est survenue.';\n          this.messageClass = 'error';\n        }\n      },\n      toggleForm() {\n        this.isLogin = !this.isLogin;\n        this.message = ''; // Réinitialiser le message à chaque changement de formulaire\n      }\n    }\n  };\n  </script>\n  \n  <style scoped>\n  /* Ajoute ton style CSS pour le formulaire si nécessaire */\n  </style>\n  "],"mappings":";AAsBE,OAAOA,KAAI,MAAO,OAAO;AAEzB,eAAe;EACbC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,KAAK,EAAE,EAAE;MACTC,IAAI,EAAE,EAAE;MACRC,QAAQ,EAAE,EAAE;MACZC,OAAO,EAAE,EAAE;MACXC,YAAY,EAAE,EAAE;MAChBC,OAAO,EAAE,IAAG,CAAE;IAChB,CAAC;EACH,CAAC;EACDC,OAAO,EAAE;IACP,MAAMC,UAAUA,CAAA,EAAG;MACjB,MAAMC,GAAE,GAAI,IAAI,CAACH,OAAM,GACnB,kCAAiC,GACjC,qCAAqC;MAEzC,MAAMI,IAAG,GAAI,IAAI,CAACJ,OAAM,GACpB;QAAEL,KAAK,EAAE,IAAI,CAACA,KAAK;QAAEE,QAAQ,EAAE,IAAI,CAACA;MAAS,IAC7C;QAAED,IAAI,EAAE,IAAI,CAACA,IAAI;QAAED,KAAK,EAAE,IAAI,CAACA,KAAK;QAAEE,QAAQ,EAAE,IAAI,CAACA;MAAS,CAAC;MAEnE,IAAI;QACF,MAAMQ,QAAO,GAAI,MAAMZ,KAAK,CAACa,IAAI,CAACH,GAAG,EAAEC,IAAI,CAAC;QAC5C,IAAI,CAACN,OAAM,GAAIO,QAAQ,CAACX,IAAI,CAACI,OAAM,IAAK,iBAAiB;QACzD,IAAI,CAACC,YAAW,GAAI,SAAS;;QAE7B;QACA,IAAI,IAAI,CAACC,OAAO,EAAE;UAChB;UACAO,YAAY,CAACC,OAAO,CAAC,cAAc,EAAEH,QAAQ,CAACX,IAAI,CAACe,YAAY,CAAC;UAChEF,YAAY,CAACC,OAAO,CAAC,eAAe,EAAEH,QAAQ,CAACX,IAAI,CAACgB,aAAa,CAAC;;UAElE;UACA,IAAI,CAACC,OAAO,CAACC,IAAI,CAAC,OAAO,CAAC;QAC5B;MACF,EAAE,OAAOC,KAAK,EAAE;QACd,IAAI,CAACf,OAAM,GAAIe,KAAK,CAACR,QAAQ,CAACX,IAAI,CAACmB,KAAI,IAAK,0BAA0B;QACtE,IAAI,CAACd,YAAW,GAAI,OAAO;MAC7B;IACF,CAAC;IACDe,UAAUA,CAAA,EAAG;MACX,IAAI,CAACd,OAAM,GAAI,CAAC,IAAI,CAACA,OAAO;MAC5B,IAAI,CAACF,OAAM,GAAI,EAAE,EAAE;IACrB;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}