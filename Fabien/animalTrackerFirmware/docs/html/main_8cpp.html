<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>animal-tracker: Référence du fichier /home/jerta/Bureau/Projet/Projet_2024/Fabien/animalTrackerFirmware/src/main.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">animal-tracker
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Généré par Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Recherche',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Chargement...</div>
<div class="SRStatus" id="Searching">Recherche...</div>
<div class="SRStatus" id="NoMatches">Aucune correspondance</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Fonctions</a>  </div>
  <div class="headertitle"><div class="title">Référence du fichier main.cpp</div></div>
</div><!--header-->
<div class="contents">

<p>Logique globale du système.  
<a href="#details">Plus de détails...</a></p>
<div class="textblock"><code>#include &quot;main.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Graphe des dépendances par inclusion de main.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="main_8cpp__incl.png" border="0" usemap="#a_2home_2jerta_2Bureau_2Projet_2Projet__2024_2Fabien_2animalTrackerFirmware_2src_2main_8cpp" alt=""/></div>
<map name="a_2home_2jerta_2Bureau_2Projet_2Projet__2024_2Fabien_2animalTrackerFirmware_2src_2main_8cpp" id="a_2home_2jerta_2Bureau_2Projet_2Projet__2024_2Fabien_2animalTrackerFirmware_2src_2main_8cpp">
<area shape="rect" title="Logique globale du système." alt="" coords="5,5,229,84"/>
<area shape="rect" title=" " alt="" coords="84,132,150,160"/>
<area shape="poly" title=" " alt="" coords="120,84,120,116,114,116,114,84"/>
</map>
</div>
</div>
<p><a href="main_8cpp_source.html">Aller au code source de ce fichier.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Fonctions</h2></td></tr>
<tr class="memitem:a4fc01d736fe50cf5b977f755b675f11d" id="r_a4fc01d736fe50cf5b977f755b675f11d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4fc01d736fe50cf5b977f755b675f11d">setup</a> ()</td></tr>
<tr class="memdesc:a4fc01d736fe50cf5b977f755b675f11d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise le système à la mise sous tension ou au redémarrage.  <br /></td></tr>
<tr class="separator:a4fc01d736fe50cf5b977f755b675f11d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe461d27b9c48d5921c00d521181f12f" id="r_afe461d27b9c48d5921c00d521181f12f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afe461d27b9c48d5921c00d521181f12f">loop</a> ()</td></tr>
<tr class="memdesc:afe461d27b9c48d5921c00d521181f12f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boucle principale du programme.  <br /></td></tr>
<tr class="separator:afe461d27b9c48d5921c00d521181f12f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Description détaillée</h2>
<div class="textblock"><p>Logique globale du système. </p>
<dl class="section author"><dt>Auteur</dt><dd>Fabien </dd></dl>
<dl class="section date"><dt>Date</dt><dd>04 2025 </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0</dd></dl>
<p>Ce fichier contient les fonctions setup et loop nécessaire au système. </p>

<p class="definition">Définition dans le fichier <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
</div><h2 class="groupheader">Documentation des fonctions</h2>
<a id="afe461d27b9c48d5921c00d521181f12f" name="afe461d27b9c48d5921c00d521181f12f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe461d27b9c48d5921c00d521181f12f">&#9670;&#160;</a></span>loop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void loop </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Boucle principale du programme. </p>
<p>Loop() gère les différentes étapes de l'application en fonction de l'état actuel du microcontrôleur.</p>
<dl class="section note"><dt>Note</dt><dd>Le système reste dans le contexte de cette fonction après l'initialisation du système. </dd></dl>

<p class="definition">Définition à la ligne <a class="el" href="main_8cpp_source.html#l00059">59</a> du fichier <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   60</span>{</div>
<div class="line"><span class="lineno">   61</span><span class="preprocessor">    #ifdef DEBUG</span></div>
<div class="line"><span class="lineno">   62</span>    Serial.printf(<span class="stringliteral">&quot;\n\n/!\\ Start of the loop() function /!\\\n\n&quot;</span>);</div>
<div class="line"><span class="lineno">   63</span><span class="preprocessor">    #endif DEBUG</span></div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span>    <span class="keywordflow">switch</span> (mcuStatus) {</div>
<div class="line"><span class="lineno">   66</span>    <span class="keywordflow">case</span> STATE_GPS_ACQUIRE:</div>
<div class="line"><span class="lineno">   67</span>        gpsAcquire();</div>
<div class="line"><span class="lineno">   68</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>    <span class="keywordflow">case</span> STATE_SEND_THRESHOLD_EXCEEDED:</div>
<div class="line"><span class="lineno">   71</span>        readSendData();</div>
<div class="line"><span class="lineno">   72</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   73</span> </div>
<div class="line"><span class="lineno">   74</span>    <span class="keywordflow">case</span> STATE_SLEEP:</div>
<div class="line"><span class="lineno">   75</span>        lowPowerSleep();</div>
<div class="line"><span class="lineno">   76</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">   79</span>        mcuStatus = STATE_SLEEP;</div>
<div class="line"><span class="lineno">   80</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   81</span>    }</div>
<div class="line"><span class="lineno">   82</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4fc01d736fe50cf5b977f755b675f11d" name="a4fc01d736fe50cf5b977f755b675f11d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fc01d736fe50cf5b977f755b675f11d">&#9670;&#160;</a></span>setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise le système à la mise sous tension ou au redémarrage. </p>
<p>Configure les interfaces de communication (série, LoRa), initialise le GPS, le timer de réveil, et réalise une première tentative d’acquisition de position. Si un fix GPS est valide, la position est stockée pour une vérification future de la distance parcourue.</p>
<dl class="section note"><dt>Note</dt><dd>Cette fonction est appelée une seule fois au démarrage du microcontrôleur. </dd></dl>

<p class="definition">Définition à la ligne <a class="el" href="main_8cpp_source.html#l00025">25</a> du fichier <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   26</span>{</div>
<div class="line"><span class="lineno">   27</span> </div>
<div class="line"><span class="lineno">   28</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno">   29</span>    Serial.begin(115200);</div>
<div class="line"><span class="lineno">   30</span>    Serial.println(<span class="stringliteral">&quot;DEBUG: Starting setup...&quot;</span>);</div>
<div class="line"><span class="lineno">   31</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   32</span> </div>
<div class="line"><span class="lineno">   33</span><span class="preprocessor">#ifndef NOLORAWAN</span></div>
<div class="line"><span class="lineno">   34</span>    <a class="code hl_function" href="loraWAN_8cpp.html#aaa9f2c9bc4be8ea8857231146ec620a0">configureJoinTTN</a>();</div>
<div class="line"><span class="lineno">   35</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   36</span> </div>
<div class="line"><span class="lineno">   37</span>    gpsAcquire();</div>
<div class="line"><span class="lineno">   38</span> </div>
<div class="line"><span class="lineno">   39</span>    <a class="code hl_function" href="powerManagement_8cpp.html#abb6608094cd8dbee51a1db2c6ee283a3">configureTimer</a>();</div>
<div class="line"><span class="lineno">   40</span> </div>
<div class="line"><span class="lineno">   41</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="gps_8cpp.html#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.location.isValid()) {</div>
<div class="line"><span class="lineno">   42</span>        <a class="code hl_variable" href="gps_8cpp.html#af5cbe348d725709e7d3ada96422e04d8">previousLatitude</a> = <a class="code hl_variable" href="gps_8cpp.html#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.location.lat();</div>
<div class="line"><span class="lineno">   43</span>        previousLongitude = <a class="code hl_variable" href="gps_8cpp.html#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.location.lng();</div>
<div class="line"><span class="lineno">   44</span>        mcuStatus = STATE_SEND_THRESHOLD_EXCEEDED;</div>
<div class="line"><span class="lineno">   45</span> </div>
<div class="line"><span class="lineno">   46</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   47</span>        mcuStatus = STATE_GPS_ACQUIRE;</div>
<div class="line"><span class="lineno">   48</span>    }</div>
<div class="line"><span class="lineno">   49</span>}</div>
<div class="ttc" id="agps_8cpp_html_af599e1dd1a7fba187c3cc26b8df8c792"><div class="ttname"><a href="gps_8cpp.html#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a></div><div class="ttdeci">Air530ZClass GPS</div><div class="ttdef"><b>Definition</b> <a href="gps_8cpp_source.html#l00017">gps.cpp:17</a></div></div>
<div class="ttc" id="agps_8cpp_html_af5cbe348d725709e7d3ada96422e04d8"><div class="ttname"><a href="gps_8cpp.html#af5cbe348d725709e7d3ada96422e04d8">previousLatitude</a></div><div class="ttdeci">double previousLatitude</div><div class="ttdef"><b>Definition</b> <a href="gps_8cpp_source.html#l00024">gps.cpp:24</a></div></div>
<div class="ttc" id="aloraWAN_8cpp_html_aaa9f2c9bc4be8ea8857231146ec620a0"><div class="ttname"><a href="loraWAN_8cpp.html#aaa9f2c9bc4be8ea8857231146ec620a0">configureJoinTTN</a></div><div class="ttdeci">void configureJoinTTN()</div><div class="ttdoc">Initialiser la connexion LoRaWAN via OTAA pour TTN.</div><div class="ttdef"><b>Definition</b> <a href="loraWAN_8cpp_source.html#l00029">loraWAN.cpp:29</a></div></div>
<div class="ttc" id="apowerManagement_8cpp_html_abb6608094cd8dbee51a1db2c6ee283a3"><div class="ttname"><a href="powerManagement_8cpp.html#abb6608094cd8dbee51a1db2c6ee283a3">configureTimer</a></div><div class="ttdeci">void configureTimer()</div><div class="ttdoc">Initialiser la connexion LoRaWAN via OTAA pour TTN.</div><div class="ttdef"><b>Definition</b> <a href="powerManagement_8cpp_source.html#l00032">powerManagement.cpp:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Généré par&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2
</small></address>
</div><!-- doc-content -->
</body>
</html>
