<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>animal-tracker: Référence du fichier /home/jerta/Bureau/Projet/Projet_2024/Fabien/animalTrackerFirmware/src/gps.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">animal-tracker
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Généré par Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Recherche',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Chargement...</div>
<div class="SRStatus" id="Searching">Recherche...</div>
<div class="SRStatus" id="NoMatches">Aucune correspondance</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Fonctions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">Référence du fichier gps.cpp</div></div>
</div><!--header-->
<div class="contents">

<p>Fichier de gestion de la logique du GPS.  
<a href="#details">Plus de détails...</a></p>
<div class="textblock"><code>#include &quot;gps.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Graphe des dépendances par inclusion de gps.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="gps_8cpp__incl.png" border="0" usemap="#a_2home_2jerta_2Bureau_2Projet_2Projet__2024_2Fabien_2animalTrackerFirmware_2src_2gps_8cpp" alt=""/></div>
<map name="a_2home_2jerta_2Bureau_2Projet_2Projet__2024_2Fabien_2animalTrackerFirmware_2src_2gps_8cpp" id="a_2home_2jerta_2Bureau_2Projet_2Projet__2024_2Fabien_2animalTrackerFirmware_2src_2gps_8cpp">
<area shape="rect" title="Fichier de gestion de la logique du GPS." alt="" coords="5,5,229,84"/>
<area shape="rect" title=" " alt="" coords="89,132,145,160"/>
<area shape="poly" title=" " alt="" coords="120,84,120,116,114,116,114,84"/>
</map>
</div>
</div>
<p><a href="gps_8cpp_source.html">Aller au code source de ce fichier.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Fonctions</h2></td></tr>
<tr class="memitem:ab9850920892b5e65e55e0abb6ef29e5c" id="r_ab9850920892b5e65e55e0abb6ef29e5c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab9850920892b5e65e55e0abb6ef29e5c">readGPSStoreAsBytes</a> (uint8_t *fullArray)</td></tr>
<tr class="memdesc:ab9850920892b5e65e55e0abb6ef29e5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lit les variables fournies par le module GPS et les stocke sous forme d'octets.  <br /></td></tr>
<tr class="separator:ab9850920892b5e65e55e0abb6ef29e5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a388b1647d2c11991865d4a1315847fa3" id="r_a388b1647d2c11991865d4a1315847fa3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a388b1647d2c11991865d4a1315847fa3">gpsAcquire</a> ()</td></tr>
<tr class="separator:a388b1647d2c11991865d4a1315847fa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:af599e1dd1a7fba187c3cc26b8df8c792" id="r_af599e1dd1a7fba187c3cc26b8df8c792"><td class="memItemLeft" align="right" valign="top">Air530ZClass&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a></td></tr>
<tr class="separator:af599e1dd1a7fba187c3cc26b8df8c792"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5cbe348d725709e7d3ada96422e04d8" id="r_af5cbe348d725709e7d3ada96422e04d8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af5cbe348d725709e7d3ada96422e04d8">previousLatitude</a> = 0.0</td></tr>
<tr class="separator:af5cbe348d725709e7d3ada96422e04d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c87e8abead8833a75225ffefa9dbfe0" id="r_a3c87e8abead8833a75225ffefa9dbfe0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3c87e8abead8833a75225ffefa9dbfe0">previousLongitude</a> = 0.0</td></tr>
<tr class="separator:a3c87e8abead8833a75225ffefa9dbfe0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Description détaillée</h2>
<div class="textblock"><p>Fichier de gestion de la logique du GPS. </p>
<p>Contient les fonctions concernant le GPS.</p>
<dl class="section author"><dt>Auteur</dt><dd>Fabien </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2025-04 </dd></dl>

<p class="definition">Définition dans le fichier <a class="el" href="gps_8cpp_source.html">gps.cpp</a>.</p>
</div><h2 class="groupheader">Documentation des fonctions</h2>
<a id="a388b1647d2c11991865d4a1315847fa3" name="a388b1647d2c11991865d4a1315847fa3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a388b1647d2c11991865d4a1315847fa3">&#9670;&#160;</a></span>gpsAcquire()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gpsAcquire </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="gps_8cpp_source.html#l00191">191</a> du fichier <a class="el" href="gps_8cpp_source.html">gps.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  192</span>{</div>
<div class="line"><span class="lineno">  193</span>    <a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.begin();</div>
<div class="line"><span class="lineno">  194</span>    delay(1000);</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span><span class="preprocessor">    #ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  197</span>        Serial.println(<span class="stringliteral">&quot;DEBUG: Acquiring GPS...&quot;</span>);</div>
<div class="line"><span class="lineno">  198</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>    uint32_t start = millis();</div>
<div class="line"><span class="lineno">  201</span>    <span class="keywordflow">while</span> ((millis() - start) &lt; GPS_UPDATE_TIMEOUT) {</div>
<div class="line"><span class="lineno">  202</span>        <span class="keywordflow">while</span> (<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.available()) <a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.encode(<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.read());</div>
<div class="line"><span class="lineno">  203</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.location.age() &lt; 1000) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  204</span>    }</div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.location.isValid()) {</div>
<div class="line"><span class="lineno">  207</span><span class="preprocessor">    #ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  208</span>            Serial.println(<span class="stringliteral">&quot;DEBUG: Invalid GPS. Skipping send.&quot;</span>);</div>
<div class="line"><span class="lineno">  209</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  210</span>        mcuStatus = STATE_SLEEP;</div>
<div class="line"><span class="lineno">  211</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  212</span>    }</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>    <span class="keywordtype">double</span> distance = <a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.distanceBetween(<a class="code hl_variable" href="#af5cbe348d725709e7d3ada96422e04d8">previousLatitude</a>, previousLongitude, <a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.location.lat(), <a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.location.lng());</div>
<div class="line"><span class="lineno">  215</span> </div>
<div class="line"><span class="lineno">  216</span><span class="preprocessor">    #ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  217</span>        Serial.printf(<span class="stringliteral">&quot;Previous: %.6f / %.6f\n&quot;</span>, <a class="code hl_variable" href="#af5cbe348d725709e7d3ada96422e04d8">previousLatitude</a>, previousLongitude);</div>
<div class="line"><span class="lineno">  218</span>        Serial.printf(<span class="stringliteral">&quot;Current : %.6f / %.6f\n&quot;</span>, <a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.location.lat(), <a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.location.lng());</div>
<div class="line"><span class="lineno">  219</span>        Serial.printf(<span class="stringliteral">&quot;Distance: %.2f meters\n&quot;</span>, distance);</div>
<div class="line"><span class="lineno">  220</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>    <span class="keywordflow">if</span> (DISTANCE_THRESHOLD == 0.0 || distance &gt; DISTANCE_THRESHOLD) {</div>
<div class="line"><span class="lineno">  223</span>        mcuStatus = STATE_SEND_THRESHOLD_EXCEEDED;</div>
<div class="line"><span class="lineno">  224</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  225</span><span class="preprocessor">    #ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  226</span>            Serial.println(<span class="stringliteral">&quot;DEBUG: No significant movement.&quot;</span>);</div>
<div class="line"><span class="lineno">  227</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  228</span>        mcuStatus = STATE_SLEEP;</div>
<div class="line"><span class="lineno">  229</span>    }</div>
<div class="line"><span class="lineno">  230</span>}</div>
<div class="ttc" id="agps_8cpp_html_af599e1dd1a7fba187c3cc26b8df8c792"><div class="ttname"><a href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a></div><div class="ttdeci">Air530ZClass GPS</div><div class="ttdef"><b>Definition</b> <a href="gps_8cpp_source.html#l00017">gps.cpp:17</a></div></div>
<div class="ttc" id="agps_8cpp_html_af5cbe348d725709e7d3ada96422e04d8"><div class="ttname"><a href="#af5cbe348d725709e7d3ada96422e04d8">previousLatitude</a></div><div class="ttdeci">double previousLatitude</div><div class="ttdef"><b>Definition</b> <a href="gps_8cpp_source.html#l00024">gps.cpp:24</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab9850920892b5e65e55e0abb6ef29e5c" name="ab9850920892b5e65e55e0abb6ef29e5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9850920892b5e65e55e0abb6ef29e5c">&#9670;&#160;</a></span>readGPSStoreAsBytes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void readGPSStoreAsBytes </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>fullArray</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Lit les variables fournies par le module GPS et les stocke sous forme d'octets. </p>
<p>En fonction des flags de compilation présent, cette fonction ajoute dans le tableau passé en paramètre les valeurs fournies par le module GPS.</p>
<p>Par souci de performance, trois variables temporaires de taille 1, 2 et 4 octets sont allouées et réutilisées selon la taille des données à traiter. Les valeurs sont transformées pour conserver uniquement la précision utile et éventuellement les rééchelonnées.</p>
<dl class="section note"><dt>Note</dt><dd>Cette fonction est appelée lorsque le système est dans l'état STATE_SEND_THRESHOLD_EXCEEDED. </dd></dl>

<p class="definition">Définition à la ligne <a class="el" href="gps_8cpp_source.html#l00040">40</a> du fichier <a class="el" href="gps_8cpp_source.html">gps.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   41</span>{</div>
<div class="line"><span class="lineno">   42</span> </div>
<div class="line"><span class="lineno">   43</span>    uint8_t *ptr = fullArray; <span class="comment">// ptr est un pointeur de type octet non signé (uint8_t) qui pointe vers l&#39;adresse de début de fullArray</span></div>
<div class="line"><span class="lineno">   44</span> </div>
<div class="line"><span class="lineno">   45</span>    uint8_t tempUint8_t = 0;</div>
<div class="line"><span class="lineno">   46</span>    uint16_t tempUint16_t = 0;</div>
<div class="line"><span class="lineno">   47</span>    uint32_t tempUint32_t = 0;</div>
<div class="line"><span class="lineno">   48</span>    int32_t tempInt32_t = 0;</div>
<div class="line"><span class="lineno">   49</span> </div>
<div class="line"><span class="lineno">   50</span><span class="preprocessor">#ifdef GPS_COORDS </span></div>
<div class="line"><span class="lineno">   51</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.location.isValid()) { <span class="comment">// Si les coordonnées sont valides, le traitement est effectué</span></div>
<div class="line"><span class="lineno">   52</span>        tempUint8_t = 0x01;       <span class="comment">// Ajout de l&#39;identifiant 1 correspondant aux coordonnées GPS (latitude, longitude)</span></div>
<div class="line"><span class="lineno">   53</span>        memcpy(ptr, &amp;tempUint8_t, <span class="keyword">sizeof</span>(uint8_t)); <span class="comment">// Copie vers ptr de l&#39;identifiant</span></div>
<div class="line"><span class="lineno">   54</span>        ptr += <span class="keyword">sizeof</span>(uint8_t); <span class="comment">// Avancer le pointeur pour préparer la copie des autres données (memcpy ne modifie pas la position du pointeur il faut donc incrémenter)</span></div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>        tempInt32_t = (int32_t)(<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.location.lat() * digitPrecision5);</div>
<div class="line"><span class="lineno">   57</span>        <span class="comment">// Conversion de la latitude : </span></div>
<div class="line"><span class="lineno">   58</span>        <span class="comment">// Multiplication par 100&#39;000 pour conserver une précision de 5 chiffres après la virgule</span></div>
<div class="line"><span class="lineno">   59</span>        <span class="comment">// Cast en entier signée</span></div>
<div class="line"><span class="lineno">   60</span>        memcpy(ptr, &amp;tempInt32_t, <span class="keyword">sizeof</span>(int32_t)); <span class="comment">// Copie de la latitude convertie vers ptr sur 4 octets</span></div>
<div class="line"><span class="lineno">   61</span>        ptr += <span class="keyword">sizeof</span>(int32_t); <span class="comment">// Avancer le pointeur pour préparer la copie des autres données </span></div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno">   64</span>        Serial.printf(<span class="stringliteral">&quot;GPS Coordinates added: Lat=%d&quot;</span>, tempInt32_t);</div>
<div class="line"><span class="lineno">   65</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>        tempInt32_t = (int32_t)(<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.location.lng() * digitPrecision5);</div>
<div class="line"><span class="lineno">   68</span>        memcpy(ptr, &amp;tempInt32_t, <span class="keyword">sizeof</span>(int32_t));</div>
<div class="line"><span class="lineno">   69</span>        ptr += <span class="keyword">sizeof</span>(int32_t);</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno">   72</span>        Serial.printf(<span class="stringliteral">&quot; Lng=%d\n&quot;</span>, tempInt32_t);</div>
<div class="line"><span class="lineno">   73</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   74</span>    }</div>
<div class="line"><span class="lineno">   75</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span><span class="preprocessor">#ifdef GPS_ALT</span></div>
<div class="line"><span class="lineno">   78</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.altitude.isValid()) {</div>
<div class="line"><span class="lineno">   79</span>        tempUint8_t = 0x02;</div>
<div class="line"><span class="lineno">   80</span>        memcpy(ptr, &amp;tempUint8_t, <span class="keyword">sizeof</span>(uint8_t));</div>
<div class="line"><span class="lineno">   81</span>        ptr += <span class="keyword">sizeof</span>(uint8_t);</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.altitude.meters() &gt;= 65535) tempUint16_t = 65535;</div>
<div class="line"><span class="lineno">   84</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.altitude.meters() &lt;= 0) tempUint16_t = 0;</div>
<div class="line"><span class="lineno">   85</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   86</span>            tempUint16_t = (uint16_t)(<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.altitude.meters() * digitPrecision2);</div>
<div class="line"><span class="lineno">   87</span>        }</div>
<div class="line"><span class="lineno">   88</span> </div>
<div class="line"><span class="lineno">   89</span>        memcpy(ptr, &amp;tempUint16_t, <span class="keyword">sizeof</span>(uint16_t));</div>
<div class="line"><span class="lineno">   90</span>        ptr += <span class="keyword">sizeof</span>(uint16_t);</div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno">   93</span>        Serial.printf(<span class="stringliteral">&quot;Altitude added: %d meters\n&quot;</span>, tempUint16_t);</div>
<div class="line"><span class="lineno">   94</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   95</span>    }</div>
<div class="line"><span class="lineno">   96</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>    <span class="comment">// Add HDOP</span></div>
<div class="line"><span class="lineno">   99</span><span class="preprocessor">#ifdef GPS_HDOP</span></div>
<div class="line"><span class="lineno">  100</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.hdop.isValid()) {</div>
<div class="line"><span class="lineno">  101</span>        tempUint8_t = 0x03; <span class="comment">// Identifier for HDOP</span></div>
<div class="line"><span class="lineno">  102</span>        memcpy(ptr, &amp;tempUint8_t, <span class="keyword">sizeof</span>(uint8_t));</div>
<div class="line"><span class="lineno">  103</span>        ptr += <span class="keyword">sizeof</span>(uint8_t);</div>
<div class="line"><span class="lineno">  104</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.hdop.value() &gt;= 255) tempUint8_t = 255;</div>
<div class="line"><span class="lineno">  105</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.hdop.value() &lt;= 0) tempUint8_t = 0;</div>
<div class="line"><span class="lineno">  106</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  107</span>            tempUint8_t = (uint8_t)(<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.hdop.value() * digitPrecision1);</div>
<div class="line"><span class="lineno">  108</span>        }</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>        memcpy(ptr, &amp;tempUint8_t, <span class="keyword">sizeof</span>(uint8_t));</div>
<div class="line"><span class="lineno">  113</span>        ptr += <span class="keyword">sizeof</span>(uint8_t);</div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  116</span>        Serial.printf(<span class="stringliteral">&quot;HDOP added: %d\n&quot;</span>, tempUint8_t);</div>
<div class="line"><span class="lineno">  117</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  118</span>    }</div>
<div class="line"><span class="lineno">  119</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>    <span class="comment">// Add speed</span></div>
<div class="line"><span class="lineno">  122</span><span class="preprocessor">#ifdef GPS_SPEED</span></div>
<div class="line"><span class="lineno">  123</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.speed.isValid()) {</div>
<div class="line"><span class="lineno">  124</span>        tempUint8_t = 0x04; <span class="comment">// Identifier for speed</span></div>
<div class="line"><span class="lineno">  125</span>        memcpy(ptr, &amp;tempUint8_t, <span class="keyword">sizeof</span>(uint8_t));</div>
<div class="line"><span class="lineno">  126</span>        ptr += <span class="keyword">sizeof</span>(uint8_t);</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.speed.mps() &gt;= 255) tempUint8_t = 255;</div>
<div class="line"><span class="lineno">  129</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.speed.mps() &lt;= 0) tempUint8_t = 0;</div>
<div class="line"><span class="lineno">  130</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  131</span>            tempUint8_t = (uint8_t)(<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.speed.mps() * digitPrecision1);</div>
<div class="line"><span class="lineno">  132</span>        }</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>        Serial.printf(<span class="stringliteral">&quot;/!\\ SPEED  value: %.5f\n&quot;</span>, <a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.speed.mps());</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>        memcpy(ptr, &amp;tempUint8_t, <span class="keyword">sizeof</span>(uint8_t));</div>
<div class="line"><span class="lineno">  138</span>        ptr += <span class="keyword">sizeof</span>(uint8_t);</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  141</span>        Serial.printf(<span class="stringliteral">&quot;Speed added: %d m/s\n&quot;</span>, tempUint8_t);</div>
<div class="line"><span class="lineno">  142</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  143</span>    }</div>
<div class="line"><span class="lineno">  144</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>    <span class="comment">// Add course</span></div>
<div class="line"><span class="lineno">  147</span><span class="preprocessor">#ifdef GPS_COURSE</span></div>
<div class="line"><span class="lineno">  148</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.course.isValid()) {</div>
<div class="line"><span class="lineno">  149</span>        tempUint8_t = 0x05; <span class="comment">// Identifier for course</span></div>
<div class="line"><span class="lineno">  150</span>        memcpy(ptr, &amp;tempUint8_t, <span class="keyword">sizeof</span>(uint8_t));</div>
<div class="line"><span class="lineno">  151</span>        ptr += <span class="keyword">sizeof</span>(uint8_t);</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>        tempUint8_t = (uint8_t) (((<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.course.deg() * 255) / 360));</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>        memcpy(ptr, &amp;tempUint8_t, <span class="keyword">sizeof</span>(uint8_t));</div>
<div class="line"><span class="lineno">  156</span>        ptr += <span class="keyword">sizeof</span>(uint8_t);</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  159</span>        Serial.printf(<span class="stringliteral">&quot;Course added: %d degrees\n&quot;</span>, tempUint8_t);</div>
<div class="line"><span class="lineno">  160</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  161</span>    }</div>
<div class="line"><span class="lineno">  162</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span><span class="preprocessor">#ifdef GPS_SATS</span></div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.satellites.isValid()) {</div>
<div class="line"><span class="lineno">  166</span>        tempUint8_t = 0x06;</div>
<div class="line"><span class="lineno">  167</span>        memcpy(ptr, &amp;tempUint8_t, <span class="keyword">sizeof</span>(uint8_t));</div>
<div class="line"><span class="lineno">  168</span>        ptr += <span class="keyword">sizeof</span>(uint8_t);</div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.satellites.value() &gt;= 255) tempUint8_t = 255;</div>
<div class="line"><span class="lineno">  171</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.satellites.value() &lt;= 0) {</div>
<div class="line"><span class="lineno">  172</span>            tempUint8_t = 0;</div>
<div class="line"><span class="lineno">  173</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  174</span>            tempUint8_t = (uint8_t) <a class="code hl_variable" href="#af599e1dd1a7fba187c3cc26b8df8c792">GPS</a>.satellites.value();</div>
<div class="line"><span class="lineno">  175</span>        }</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>        memcpy(ptr, &amp;tempUint8_t, <span class="keyword">sizeof</span>(uint8_t));</div>
<div class="line"><span class="lineno">  178</span>        ptr += <span class="keyword">sizeof</span>(uint8_t);</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  181</span>        Serial.printf(<span class="stringliteral">&quot;Satellites added: %d\n&quot;</span>, tempUint8_t);</div>
<div class="line"><span class="lineno">  182</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  183</span>    }</div>
<div class="line"><span class="lineno">  184</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  187</span>    printDebugInfo(ptr - fullArray, fullArray);</div>
<div class="line"><span class="lineno">  188</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  189</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Documentation des variables</h2>
<a id="af599e1dd1a7fba187c3cc26b8df8c792" name="af599e1dd1a7fba187c3cc26b8df8c792"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af599e1dd1a7fba187c3cc26b8df8c792">&#9670;&#160;</a></span>GPS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Air530ZClass GPS</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Création d'une instance de la classe Air530ZClass nommée GPS, utilisée pour interagir avec le module GPS Air530Z. </p>

<p class="definition">Définition à la ligne <a class="el" href="gps_8cpp_source.html#l00017">17</a> du fichier <a class="el" href="gps_8cpp_source.html">gps.cpp</a>.</p>

</div>
</div>
<a id="af5cbe348d725709e7d3ada96422e04d8" name="af5cbe348d725709e7d3ada96422e04d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5cbe348d725709e7d3ada96422e04d8">&#9670;&#160;</a></span>previousLatitude</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double previousLatitude = 0.0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Variables pour stocker les coordonnées précédentes de localisation GPS. Ces valeurs permettent de comparer la position actuelle avec la position précédente, par exemple pour calculer une distance parcourue ou détecter un mouvement. </p>

<p class="definition">Définition à la ligne <a class="el" href="gps_8cpp_source.html#l00024">24</a> du fichier <a class="el" href="gps_8cpp_source.html">gps.cpp</a>.</p>

</div>
</div>
<a id="a3c87e8abead8833a75225ffefa9dbfe0" name="a3c87e8abead8833a75225ffefa9dbfe0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c87e8abead8833a75225ffefa9dbfe0">&#9670;&#160;</a></span>previousLongitude</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double previousLongitude = 0.0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Définition à la ligne <a class="el" href="gps_8cpp_source.html#l00025">25</a> du fichier <a class="el" href="gps_8cpp_source.html">gps.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Généré par&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2
</small></address>
</div><!-- doc-content -->
</body>
</html>
