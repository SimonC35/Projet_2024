\doxysection{Référence du fichier /home/jerta/\+Bureau/\+Projet/\+Projet\+\_\+2024/\+Fabien/animal\+Tracker\+Firmware/src/main.cpp}
\hypertarget{main_8cpp}{}\label{main_8cpp}\index{/home/jerta/Bureau/Projet/Projet\_2024/Fabien/animalTrackerFirmware/src/main.cpp@{/home/jerta/Bureau/Projet/Projet\_2024/Fabien/animalTrackerFirmware/src/main.cpp}}


Logique globale du système.  


{\ttfamily \#include "{}main.\+h"{}}\newline
Graphe des dépendances par inclusion de main.\+cpp\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=248pt]{main_8cpp__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Fonctions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{main_8cpp_a4fc01d736fe50cf5b977f755b675f11d}{setup}} ()
\begin{DoxyCompactList}\small\item\em Initialise le système à la mise sous tension ou au redémarrage. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{main_8cpp_afe461d27b9c48d5921c00d521181f12f}{loop}} ()
\begin{DoxyCompactList}\small\item\em Boucle principale du programme. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Description détaillée}
Logique globale du système. 

\begin{DoxyAuthor}{Auteur}
Fabien 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
04 2025 
\end{DoxyDate}
\begin{DoxyVersion}{Version}
1.\+0
\end{DoxyVersion}
Ce fichier contient les fonctions setup et loop nécessaire au système. 

Définition dans le fichier \mbox{\hyperlink{main_8cpp_source}{main.\+cpp}}.



\doxysubsection{Documentation des fonctions}
\Hypertarget{main_8cpp_afe461d27b9c48d5921c00d521181f12f}\index{main.cpp@{main.cpp}!loop@{loop}}
\index{loop@{loop}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{loop()}{loop()}}
{\footnotesize\ttfamily \label{main_8cpp_afe461d27b9c48d5921c00d521181f12f} 
void loop (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Boucle principale du programme. 

Loop() gère les différentes étapes de l\textquotesingle{}application en fonction de l\textquotesingle{}état actuel du microcontrôleur.

\begin{DoxyNote}{Note}
Le système reste dans le contexte de cette fonction après l\textquotesingle{}initialisation du système. 
\end{DoxyNote}


Définition à la ligne \mbox{\hyperlink{main_8cpp_source_l00059}{59}} du fichier \mbox{\hyperlink{main_8cpp_source}{main.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00060\ \{}
\DoxyCodeLine{00061\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ DEBUG}}
\DoxyCodeLine{00062\ \ \ \ \ Serial.printf(\textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n/!\(\backslash\)\(\backslash\)\ Start\ of\ the\ loop()\ function\ /!\(\backslash\)\(\backslash\)\(\backslash\)n\(\backslash\)n"{}});}
\DoxyCodeLine{00063\ \textcolor{preprocessor}{\ \ \ \ \#endif\ DEBUG}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keywordflow}{switch}\ (mcuStatus)\ \{}
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keywordflow}{case}\ STATE\_GPS\_ACQUIRE:}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ gpsAcquire();}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{keywordflow}{case}\ STATE\_SEND\_THRESHOLD\_EXCEEDED:}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ readSendData();}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{keywordflow}{case}\ STATE\_SLEEP:}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ lowPowerSleep();}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ mcuStatus\ =\ STATE\_SLEEP;}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00081\ \ \ \ \ \}}
\DoxyCodeLine{00082\ \}}

\end{DoxyCode}
\Hypertarget{main_8cpp_a4fc01d736fe50cf5b977f755b675f11d}\index{main.cpp@{main.cpp}!setup@{setup}}
\index{setup@{setup}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{setup()}{setup()}}
{\footnotesize\ttfamily \label{main_8cpp_a4fc01d736fe50cf5b977f755b675f11d} 
void setup (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Initialise le système à la mise sous tension ou au redémarrage. 

Configure les interfaces de communication (série, Lo\+Ra), initialise le GPS, le timer de réveil, et réalise une première tentative d’acquisition de position. Si un fix GPS est valide, la position est stockée pour une vérification future de la distance parcourue.

\begin{DoxyNote}{Note}
Cette fonction est appelée une seule fois au démarrage du microcontrôleur. 
\end{DoxyNote}


Définition à la ligne \mbox{\hyperlink{main_8cpp_source_l00025}{25}} du fichier \mbox{\hyperlink{main_8cpp_source}{main.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00026\ \{}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#ifdef\ DEBUG}}
\DoxyCodeLine{00029\ \ \ \ \ Serial.begin(115200);}
\DoxyCodeLine{00030\ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}DEBUG:\ Starting\ setup..."{}});}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#ifndef\ NOLORAWAN}}
\DoxyCodeLine{00034\ \ \ \ \ \mbox{\hyperlink{loraWAN_8cpp_aaa9f2c9bc4be8ea8857231146ec620a0}{configureJoinTTN}}();}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \ \ gpsAcquire();}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \ \ \mbox{\hyperlink{powerManagement_8cpp_abb6608094cd8dbee51a1db2c6ee283a3}{configureTimer}}();}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{gps_8cpp_af599e1dd1a7fba187c3cc26b8df8c792}{GPS}}.location.isValid())\ \{}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{gps_8cpp_af5cbe348d725709e7d3ada96422e04d8}{previousLatitude}}\ =\ \mbox{\hyperlink{gps_8cpp_af599e1dd1a7fba187c3cc26b8df8c792}{GPS}}.location.lat();}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ previousLongitude\ =\ \mbox{\hyperlink{gps_8cpp_af599e1dd1a7fba187c3cc26b8df8c792}{GPS}}.location.lng();}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ mcuStatus\ =\ STATE\_SEND\_THRESHOLD\_EXCEEDED;}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ mcuStatus\ =\ STATE\_GPS\_ACQUIRE;}
\DoxyCodeLine{00048\ \ \ \ \ \}}
\DoxyCodeLine{00049\ \}}

\end{DoxyCode}
